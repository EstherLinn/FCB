$(function(){$("[data-filter-collapse]").on("click",function(t){t.preventDefault(),$("body").toggleClass("is-filterOpen"),"mobile"!==getComputedStyle(document.documentElement).getPropertyValue("--layout")?(t=$("[data-filter]").hasClass("is-collapse"),$('[data-filter-hide="desktop"]').animate({height:t?$('[data-filter-wrap="desktop"]').outerHeight():0},300,function(){$('[data-filter-hide="desktop"]').removeAttr("style"),$("[data-filter]").toggleClass("is-collapse is-expand")})):$("[data-filter]").toggleClass("is-collapse is-expand")}),$("[data-filter-checkbox]").on("change.filter",function(){r(),$(this).closest("[data-filter-group]").find("[data-filter-checkall]").prop("checked",0<!$(this).closest("[data-filter-group]").find("[data-filter-checkbox] input:checked").length)}),$("[data-filter-checkall]").on("change.checkAll",function(t){$(this).prop("checked",!0),$(this).closest("[data-filter-group]").find("[data-filter-checkbox] input").each((t,a)=>{$(a).prop("checked",!1)}),$("[data-filter-checkbox]").trigger("change.filter")});let l=[];function e(t){return-1===l.indexOf(t)&&t.trim()}function r(){let i=[];$("[data-filter-tags]").empty(),$("[data-filter-group]").each((e,t)=>{var a=0<$(t).find("[data-filter-part]").length;i.push({title:$(t).find("[data-filter-title] span").text(),part:a,special:"special"===$(t).data("filter-group"),val:[]}),a?$(`[data-part-id="${$(t).find("[data-filter-part]").data("filter-part")}"]`).each((t,a)=>{"string"!=typeof d(a)?d(a)&&(i[e].val=[...i[e].val,...d(a)]):i[e].val.push(d(a))}):"string"!=typeof d(t)?d(t)&&(i[e].val=[...d(t)]):i[e].val.push(d(t))}),i[0].val=l,$("[data-filter-block]").toggleClass("no-picked",i.filter(t=>!t.special&&0<t.val.length).length<=0),i.forEach((i,l)=>{if(!i.special)if(i.part){let e="";var t=$("[data-filter-group]").eq(l).find("[data-part-divide]").data("part-divide"),r=t||"/";i.val.forEach((t,a)=>{a=0===a?"":r;e=e+a+t});t=$(`<div class="l-pickGroup__item" data-filter-tag="${c(i.title)}">
                    <div class="o-pickedTag">
                        <div class="o-pickedTag__text">${c(i.title)} ${c(e)}</div>
                        <a href="#" class="o-pickedTag__button" data-tag-close></a>
                    </div>
                </div>`);n(t,l,e),$("[data-filter-tags]").append(t)}else i.val.forEach(t=>{var a=$(`<div class="l-pickGroup__item" data-filter-tag="${c(i.title)}">
                        <div class="o-pickedTag">
                            <div class="o-pickedTag__text">${c(i.title)} ${c(t)}</div>
                            <a href="#" class="o-pickedTag__button" data-tag-close></a>
                        </div>
                    </div>`);n(a,l,t),$("[data-filter-tags]").append(a)})})}function d(t){if(0<$(t).find("[data-filter-checkbox] input:checked").length){let e=[];return $(t).find("[data-filter-checkbox] input:checked").each((t,a)=>{e.push($(a).closest("[data-filter-checkbox]").find("[data-filter-value]").data("filter-value"))}),e}return $(t).find("[data-filter-input]").val()?$(t).find("[data-filter-input]").val():$(t).find("[data-filter-bar]").data("filter-bar")?$(t).find("[data-filter-bar]").data("filter-bar"):0<$(t).find("[data-filter-radio] input:checked").length?$(t).find("[data-filter-radio] input:checked").closest("[data-filter-radio]").find("[data-filter-value]").data("filter-value"):void 0}function n(t,e,i){t.find(".o-pickedTag__button").on("click.tag",function(t){if(t.preventDefault(),0===e)return l.splice(l.indexOf(i),1),r(),window.loading("show"),void setTimeout(()=>{window.loading("hide")},300);const a=$("[data-filter-group]").eq(e);a.find(`[data-filter-value="${i}"]`).closest("[data-filter-checkbox]").find("input").prop("checked",!1).trigger("change"),a.find("[data-filter-bar]").val("").trigger("input.reset"),a.find("[data-filter-radio] input:checked").prop("checked",!1).trigger("change"),a.find("[data-filter-input]").val("").trigger("change"),0<a.find('[data-filter-input][data-calendar="true"]').length&&a.find('[data-filter-input][data-calendar="true"]').datepicker("update")})}function c(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}$("[data-keyword-submit]").on("click.filter",function(){const t=$("[data-keyword-input]").val();e(t)&&(l.push(t.trim()),r())}),$("[data-keyword-input]").on("keypress.filter",function(t){const a=$(this).val();13===t.which&&e(a)&&(l.push(a.trim()),r())}),$("[data-slider-val]").on("change.sliderBar",function(){let t=$(this).val().split(",");var a=$(this).data("slider-prefix");a&&(t=t.map(t=>"min"!==t&&"max"!==t?`${a+t}`:t));var e=$(this).data("slider-suffix");e&&(t=t.map(t=>"min"!==t&&"max"!==t?`${t+e}`:t)),t="min"===t[0]&&"max"===t[1]?"":"min"===t[1]?$(this).siblings("[data-slider-bar]").find(".noUi-value").eq(1).text()+"(不含)以下":"max"===t[0]?$(this).siblings("[data-slider-bar]").find(".noUi-value").eq($(this).siblings("[data-slider-bar]").find(".noUi-value").length-2).text()+"(不含)以上":"min"===t[0]?t[1]+"以下":"max"===t[1]?t[0]+"以上":t[0]===t[1]?t[0]:`${t[0]} ~ ${t[1]}`,$(this).data("filter-bar",t),r()}),$("[data-filter-radio]").on("change.filter",function(){r()}),$("[data-filter-input]").on("change.filter",function(){$(this).val($(this).val().toString().trim()),r()}),$("[data-filter-reset]").on("click.reset",function(t){t.preventDefault(),l=[],$("[data-keyword-input]").val(""),$("[data-filter-checkbox] input, [data-filter-radio] input").prop("checked",!1).trigger("change"),$("[data-filter-bar]").val("").trigger("input.reset"),$("[data-filter-input]").val("").trigger("change"),0<$('[data-filter-input][data-calendar="true"]').length&&$('[data-filter-input][data-calendar="true"]').datepicker("update")})});