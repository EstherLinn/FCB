@* model Xcms.Sitecore.Feature.Navigation.Models.NavigationMenu *@
@using Feature.Wealth.Component.Models.Navigation
@using Xcms.Sitecore.Feature.Navigation.Models
@using Xcms.Sitecore.Foundation.Basic.SitecoreExtensions
@inherits Xcms.Sitecore.Foundation.Basic.MVC.EditorCompatibleView<Xcms.Sitecore.Feature.Navigation.Models.NavigationMenu>

@if (Model == null)
{
    return;
}
<div class="l-header__menu">
    <nav class="c-menu c-menu--lv1">
        <div class="c-menu__wrap c-menu__wrap--lv1">
            @* 切 *@
            <menu class="c-menu__list c-menu__list--lv1">
                @foreach (var node in Model.Children)
                {
                    switch (node)
                    {
                        case NavigationPageLink pageLinkLv:
                            if (pageLinkLv.Item.IsChecked(Templates.Navigable.Fields.ShowNavigation))
                            {
                                <li class="c-menu__item c-menu__item--lv1">
                                    <!-- 第一層選單要加[data-megamenu="true"]以綁定互動操作功能 -->
                                    <a href="@(pageLinkLv.Link?.Url)" target="@(pageLinkLv.Link?.Target)" class="c-menu__name c-menu__name--lv1" data-megamenu="true">
                                        @Html.Sitecore().Field(Templates.IconNavigationLink.Fields.Icon, pageLinkLv.Item, new { disableWebEditing = true })
                                        @pageLinkLv.GetBestLinkText()
                                    </a>
                                    @if (pageLinkLv.Item.IsChecked(Templates.Navigable.Fields.ShowChildren))
                                    {
                                        <div class="c-menu c-menu--lv2">
                                            <div class="c-menu__wrap c-menu__wrap--lv2">
                                                <menu class="c-menu__list c-menu__list--lv2">
                                                    @{
                                                        foreach (var child in pageLinkLv.Children)
                                                        {
                                                            if (child is NavigationPageLink pageLinkLv1 && pageLinkLv1.Item.IsChecked(Templates.Navigable.Fields.ShowNavigation))
                                                            {
                                                                <li class="c-menu__item c-menu__item--lv2">
                                                                    <a href="#" class="c-menu__name c-menu__name--lv2">@pageLinkLv1.GetBestLinkText()</a>
                                                                    @if (pageLinkLv1.Item.IsChecked(Templates.Navigable.Fields.ShowChildren))
                                                                    {
                                                                        <div class="c-menu c-menu--lv3">
                                                                            <div class="c-menu__wrap c-menu__wrap--lv3">
                                                                                <menu class="c-menu__list c-menu__list--lv3">
                                                                                    @foreach (var childLv2 in pageLinkLv1.Children)
                                                                                    {
                                                                                        if (childLv2 is NavigationPageLink pageLinkLv2 && pageLinkLv2.Item.IsChecked(Templates.Navigable.Fields.ShowNavigation))
                                                                                        {
                                                                                            <li class="c-menu__item c-menu__item--lv3">
                                                                                                <a href="@(pageLinkLv2.Link?.Url)" target="@(pageLinkLv2.Link?.Target)" class="c-menu__name c-menu__name--lv3">
                                                                                                    @Html.Sitecore().Field(Templates.IconNavigationLink.Fields.Icon, pageLinkLv2.Item, new { disableWebEditing = true })
                                                                                                    @pageLinkLv2.GetBestLinkText()
                                                                                                </a>
                                                                                            </li>
                                                                                        }
                                                                                    }
                                                                                </menu>
                                                                            </div>
                                                                        </div>
                                                                    }
                                                                </li>
                                                            }
                                                        }
                                                    }
                                                </menu>
                                                @{
                                                    var item = pageLinkLv.Item;
                                                    string image = item.ImageUrl(Templates.ImageNavigationLink.Fields.Image);
                                                    if (!string.IsNullOrEmpty(image)|| !item.IsChecked(Templates.Navigable.Fields.ShowNavigation))
                                                    {
                                                        <div class="c-menu__banner">
                                                            <article class="c-banner c-banner--menu">
                                                                <img src="@image" class="c-banner__img" alt="">
                                                                <div class="c-banner__content">
                                                                    <h3 class="c-banner__title">@item.Field(Templates.ImageNavigationLink.Fields.Title)</h3>
                                                                    <p class="c-banner__slogan">@item.Field(Templates.ImageNavigationLink.Fields.Slogan)</p>
                                                                    <div class="c-banner__actions">
                                                                        @{
                                                                            var link = item.GeneralLink(Templates.ImageNavigationLink.Fields.ButtonLink);
                                                                            <a href="@(link?.Url)" target="@(link?.Target)" class="o-btn o-btn--primary o-btn--thin o-btn--auto">@item.Field(Templates.ImageNavigationLink.Fields.ButtonText)</a>
                                                                        }
                                                                    </div>
                                                                </div>
                                                            </article>
                                                        </div>
                                                    }
                                                }
                                            </div>
                                        </div>
                                    }
                                </li>
                            }

                            break;
                    }
                }
            </menu>
        </div>
    </nav>
</div>